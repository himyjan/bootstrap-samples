@page
@model Bootstrap5ModalExample.Pages.Dialog2Model
@{
}
<style>
    .bar {
    }
</style>


<div class="container">
    <h1 class="fs-5">Modal with progress bar</h1>
    <button id="btn-confirm" role="button" class="btn btn-primary" data-toggle="modal">Submit</button>
</div>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title in fs-5" id="modalLabel">Please Wait</h1>
            </div>
            <div class="modal-body">
                <div class="progress">
                    <div class="progress-bar bar" 
                         id="progress" 
                         role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" max="100">
                    </div>
                </div>
            </div>
            <div class="modal-footer text-center">
                <div class="me-auto fs-6 text-muted">Saving changes</div>
            </div>
        </div>
    </div>
</div>

@section Scripts
    {
    <script>

        document.getElementById("btn-confirm").addEventListener("click", function () {
            $("#myModal").modal('show');

            setTimeout(function() {
                $('#myModal').modal('toggle');
            }, 12000);

            var element = document.getElementById("progress");
            var width = 1;
            var identity = setInterval(performWork, 100);

            function performWork() {
                if (width >= 100) {
                    clearInterval(identity);

                } else {
                    width++; 
                    $("#progress")
                        .css("width", width + "%")
                        .attr("aria-valuenow", width)
                        .text(width + "% Complete");
                }
            }
        });

        $("#modal-btn-no").on("click", function () {
            $('#myModal .hide,#myModal .in').toggleClass('hide in');
            $("#myModal").modal('hide');
        });

        $('#myModal').on('hidden.bs.modal', function () {
            // reset modal

            if ($('#myModal').data('reenable')) {
                $(this).removeData();
                $('#myModal').modal({
                    show: true
                });
            }
        });
    </script>
}
